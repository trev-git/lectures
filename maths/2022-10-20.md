# Транспортная задача

## Постановка задачи

Имеются $m$ пунктов отправления $A_1...A_m$, в которых сосредоточены запасы однородного груза в количестве $a_1...a_m$ соответственно. Этот груз необходимо доставить в $n$ пунктов назначения (ПН) $B_1...B_n$ в количестве $b_1...b_n$ соответственно.

Стоимость перевозки единицы груза из пункта $A_i$ в пункт $B_j$ равна $c_{ij}$ (тариф).

Требуется составить такой план перевозок, чтобы все заявки были выполнены; все запасы исчерпаны; а общая стоимость всех перевозок была бы минимальной.

В зависимости от соотношения между суммарными запасами груза и суммарными потребностями в нём транспортные задачи могут быть закрытыми и открытыми.

**Транспортная задача называется закрытой, если сумма всех заявок равна сумме всех запасов, т.е.** $\sum\limits_{i=1}^ma_i=\sum\limits_{j=1}^nb_j$

Обозначим через $x_{ij}$ количество груза, перевозимого из пункта $A_i$ в пункт $B_j$. Получим матрицу перевозок

$$
\begin{bmatrix}
    x_{11}&x_{12}&\dots&x_{1n}  \\
    x_{21}&x_{22}&\dots&x_{2n}  \\
    \vdots&\vdots&\ddots&\vdots \\
    x_{m1}&x_{m2}&\dots&x_{mn}  \\
\end{bmatrix}
$$

Перевозки должны удовлетворять двум условиям:

1) суммарное количество груза вывозимого из каждого ПО во все ПН, должно быть равно запасу груза в этом ПО:

$$
\begin{cases}
    x_{11}+x_{12}+\dots+x_{1n}=a_1 \\
    x_{21}+x_{22}+\dots+x_{1n}=a_1 \\
    \cdots \\
    x_{m1}+x_{m2}+\dots+x_{mn}=a_m \\
    
\end{cases}

(1)\sum\limits_{j=1}^nx_{ij}=a_i (i = 1\dots m)
$$

2) суммарное количество груза, привозимого в каждый ПН из всех ПО, должно быть равно заявке, поданной этим ПН:

$$
\begin{cases}
    x_{11}+x_{12}+\dots+x_{1n}=b_1 \\
    x_{21}+x_{22}+\dots+x_{1n}=b_1 \\
    \cdots \\
    x_{m1}+x_{m2}+\dots+x_{mn}=b_m \\
    
\end{cases}

(2)\:\sum\limits_{j=1}^mx_{ij}=b_j (j = 1\dots n)
$$

Суммарная стоимость все перевозок должна быть минимальной, т.е. $z=\sum\limits_{i=1}^m\sum\limits_{j=1}^nc_{ij}\cdot x_{ij}\Rightarrow\min$

**План перевозок называется допустимым, если все запасы исчерпаны и все заявки удовлетворены, т.е допустимый план удовлетворяет системе ограничений (1) и (2).**

**Допустимый план называется опорным, если в нём отличны от нуля не более $m+n-1$ базисных перевозок $x_{ij}$, а все остальные перевозки равны нулю.**

**План перевозок называется оптимальным, если он среди всех допустимых планов приводит к минимальной стоимости перевозок.**

Транспортная задача как задача линейного программирования может быть решена симплексным методом, однако большое число переменных и ограничений делает вычисления громоздкими. Поэтому для решения транспортных задач разработан специальный метод, имеющий те же этапы, что и симплексный метод:

- нахождение исходного опорного решения (метод северо-западного угла, минимальной стоимости или метод Фогеля);
- проверка этого решения на оптимальность (метод потенциалов, метод пересчёта циклов);
- переход от одного опорного решения к другому.

## Метод наименьшей стоимости

Метод наименьшей стоимостей позволяет построить опорный план перевозок, достаточно близкий к оптимальному, так как использует матрицу тарифов транспортной задачи $C=(c_{ij})$.

Согласно этому методу груз распределяется в первую очередь в те ячейки, в которых указан минимальный тариф перевозок $c_{ij}$. Далее поставки распределяются в незанятые ячейки с наименьшими тарифами с учётом оставшихся запасов у поставщиков и удовлетворения спроса потребителей.

Поставщик исключается из рассмотрения, если его запасы груза использованы полностью. Потребитель исключается из рассмотрения, если его запросы удовлетворены полностью. На каждом шаге исключается либо один поставщик, либо один потребитель. При этом если поставщик ещё не исключен, но его запасы равны нулю, то на том шаге, когда от данного поставщика требуется поставить груз, в соответствующую клетку таблицы заносится базисный нуль и лишь затем поставщик исключается их рассмотрения (аналогично с потребителем).

Процесс распределения продолжают до тех пор, пока все грузы от поставщиков не буду вывезена, а потребители не будут удовлетворены.

Количество базисных переменных (клеток), в которых значение перевозок неотрицательно ($x_{ij}\ge 0$), должно быть равно $m+n-1$.

# Метод потенциалов

Для определения оптимальности плана используют метод потенциалов.

В методе потенциалов каждой строке и каждому столбцу транспортной таблицы ставятся в соответствие числа $\alpha_i$ и $\beta_j$, называемых потенциалами.

Обозначим через $C_{ij}$ сумму $\alpha_i$ и $\beta_j$, и будем называть её псевдостоимостью перевозки единицы груза из пункта $A_i$ в пункт $B_j$.

Потенциалы $\alpha_i$ и $\beta_j$ находят из равенства $\alpha_i+\beta_i=c_{ij}$ справедливого для занятых (базисных) клеток. Значения потенциалов можно определить, придавая одному из них произвольное значение (обычно $\alpha_i=0$).

После того, как определены все потенциалы, вычисляют псевдостоимости в свободных клетках $\tilde{c_{ij}}=\alpha_i+\beta_i$.

Для включения в базис выбирается свободная клетка, в которой разность $\tilde{c_{ij}}-c_{ij}$.

## Построение цикла

После определения вводимой в базис клетки, необходимо определить выводимую из базиса переменную. Для этой цели для вводимой в базис клетки строится цикл.

**Циклом в транспортной таблице называется несколько клеток, соединённых замкнутой ломаной линией, которая в каждой клетке совершает поворот на $90\degree$.**

<u>Теорема.</u> В опорном плане для каждой свободной клетки транспортной таблицы существует цикл, и притом единственный, первая вершина которого лежит в данной свободной клетке, а остальные, в базисных клетках таблицы.

I want to fucking die

Каждый цикл имеет чётное число вершин. Отметим знаком "+" нечётные вершины, в них перевозки увеличиваются. Знаком "-" обозначим чётные вершины, в них перевозки уменьшаются.

Цикл, в котором вершины помечены "+" и "-", называются означенным.

Ценой цикла называется увеличение стоимости перевозок при перемещении единицы груза по означенному циклу.

Цена цикла равна алгебраической сумме стоимостей. стоящих в вершинах цикла. Очевидно, что для улучшения плана имеет смысл перемещать груз по циклам с отрицательной ценой. Стоимость плана при этом будет уменьшаться на величину $k\cdot\gamma$, где $k$ - количество единиц груза, перемещаемого по циклу, цена которого $\gamma$. Значение $k$ определяет ту базисную переменную, которая выйдет из базиса. $k$ - наименьшее значение перевозок, помеченных "-".

<u>Теорема</u> Для каждой свободной  клетки транспортной таблицы цена цикла равна разности между стоимостью $c_{ij}$ и псевдостоимостью $\tilde{c_{ij}}$ в данной клетке, т.е. $\gamma_{ij} = c_{ij}-\tilde{c_{ij}}$.

Если циклов с отрицательной ценой нет, то это означает, что дальнейшее улучшение плана невозможно, т.е. достигнут оптимального плана перевозок.

Таким образом, признаком оптимальности плана является выполнение двух условий:

- $\tilde{c_{ij}}=c_{ij}$ - для базисных клеток;
- $\tilde{c_{ij}}\le c_{ij}$ - для свободных клеток.

Метод потенциалов позволяет автоматически выделять клетки с отрицательной ценой цикла.
