# Метод динамического программирования

Экономический процесс считается управляемым, если можно влиять на ход его развития. Под управлением понимается совокупность решений, принимаемых на каждом этапе для влияния на ход развития процесса. Например, выпуск продукции предприятием - управляемый процесс. Совокупность решений, принимаемых в начале года по обеспечению предприятия сырьём, замене оборудования, финансированию и иным подобным вопросам, является управлением. Необходимо организовать выпуск продукции так, чтобы принятые на отдельных этапах решения способствовали получению максимально возможного объёма продукции или прибыли.

Динамического программирование позволяет свести одну сложную задачу со многими переменными ко многим задачам с малым числом переменных. Это значительно сокращает объём вычислений и ускоряет процесс принятия управленческого решения.

В отличие от линейного программирования, в котором симплексный метод является универсальным методом решения, в динамическом программировании универсального метода не существует. Один из основных методов динамического программирования - метод рекуррентных соотношений, которых основывается на использовании принципа оптимальности, разработанного американским математиком Р. Беллманом. Принцип состоит в том, что, каковы бы ни были начальное состояние на любом шаге и управление, выбранное на этом шаге, последующие управления должны выбираться оптимальными относительно состояния, к которому придёт система в конце данного шага. Использование такого принципа гарантирует, что **управление, выбранное на любом шаге, является не только локально лучшим, но и лучшим с точки зрения процесса в целом.**

Характерным для динамического программирования является подход к решению задачи по этапам, с каждым из которых ассоциирована одна управляемая переменная, называемая шаговым управлением. **Шаговое управлении - это такое решение, от которого зависит выигрыш на конкретном этапе.**

Набор рекуррентных вычислительных процедур, связывающих различные этапы, обеспечиваем получение оптимального решения задачи в целом при достижении последнего этапа.

Предположим, что некоторую задачу можно разбит на m шагов (этапов). Эффективность каждого шага характеризуется показателем эффективности W. Выигрыш всей задачи складывается из выигрышей на отдельных шагах:

$$
W=\sum\limits_{i=1}^mw_i
$$

где $w_i$ - выигрыш на i-том шаге.

Задача представляет собой управляемый процесс, т.е. на исход задачи можно влиять, используя шаговые управления. Совокупность всех шаговых управлений представляет собой управление задачей в целом

$$
X=(x_1;x2;\dots;x_m)
$$

где $x_i$ - управление на i-том шаге (шаговое управление)

Требуется найти такое управление $X$, при котором выигрыш всей задачи $W$ обращается в максимум.

$$
W=\sum\limits_{i=1}^mw_i\rightarrow\max
$$

Оптимальным управлением называется такое управление $X$, при котором достигается максимальный выигрыш задачи.

Максимальный (оптимальный) выигрыш $W^*$ - это максимальное значение из всех выигрышей $W(x)$ по всем управлениям $X$, возможным в данных условиях.

В основе метода ДП лежит идея постепенной, пошаговой оптимизации. Планируя многошаговую, необходимо выбирать управление на каждом шаге с учётом всех его будущих последствий на ещё предстоящих шагах Управление на i-том шаге выбирается так, чтобы была максимальна сумма выигрышей на всех оставшихся до конца шагах, начиная с данного шага.

# Задача распределения ресурсов

## Постановка задачи

Имеется m предприятий $П_1, П_2, \dots, П_m$, между которыми необходимо распределить некоторый запас средств (ресурсов) $K$. Каждое из предприятий $П_i$, при вложении в него средств $x$ $(0\le x\le K)$, приносит доход $\phi_i(x)$. Функции дохода $\phi_i(x)$ $(i=1\dots{m})$ известны. Требуется найти такое распределение ресурсов $K$ между предприятиями, при котором эти предприятия в сумме бы дали максимальный доход.

## Условные обозначения

Распределение ресурсов произовидтся поэтапно (по шагам). За первый шаг принимается вложение средств в предприятие $П_1$, за второй шаг - вложение средств в предприятие $П_2$ и т. д. За последний шаг ($m$) принимается вложение средств в предприятие $П_m$.

Пусть $S$ - наличный запас ещё не вложенных средств; $x_i(S)$ - «условное оптимальное управление» - это средства, выделяемые предприятию $П_i$; $W_i(S)$ - «условный оптимальный выигрыш».

Требуется найти оптимальное управление $X^*$, при котором выигрыш всей задачи $W$ обращается в максимум.

## Ход решения задачи

Оптимизация шага $m$. пусть $S$ - остаток средств, которые полностью вкладываются в последнее предприятие $П_m$. Следовательно, $x_m(S)=S;$ $W_m(S) = \phi_m(S)$. задавая различные значения $S$, находят значения $x_m(S)$ и $W_m(S)$.

Оптимизация шага $m-1$. Пусть $S$ - остаток средств перед эти шагом. Если предприятию $П_{m-1}$ выделить $x$ средств, то на последний шаг останется $S-x$ средств. Тогда условный оптимальный выигрыш за последние два шага ($m$ и $m-1$) $W_{m-1}(S)$ будет складываться из дохода предприятия $П_{m-1}$, при вложении в него средств $x$, и условного оптимального выигрыша последнего шага, на который останется средств $S-x$. Необходимо найти такое значение $x$, при котором этот выигрыш будет максимальным.

$$
W_{m-1}(S)=\max\limits_{0\le{x}\le{S}}\{\phi_{m-1}(x)+W_m(S-x)\}
$$

Т.е. условный оптимальный выигрыш за последние два шага - это максимальное значение по всем возможным вариантам $x$ от выражения, стоящего в фигурных скобках. Значение $x$, при котором этот максимум достигается, - это условное оптимальное управление на $(m-1)^{ом}$ шаге.

Далее оптимизируется $(m-2)^{ой}$, $(m-3)^{ий}$ и последующие шаги.. Вообще, для любого $i^{ого}$ шага, условный оптимальный выигрыш за все шаги, начиная c этого и до конца, вычисляются по формуле:

$$
W_i(S) = \max\limits_{0\le{x}\le{S}}\{\phi_i(x) + W_{i+1}(S-x)\}
$$

Соответствующее ему условное оптимальное управление $x_i(S)$ - это то значение $x$, при котором этот максимум достигается.

## Оптимизация первого шага.

На этом шаге не нужно перебирать значения $S$, т. к. запас средств перед первым шагом равен $K$ $(S=K)$.

$$
W_i(K) = \max\limits_{0\le{x}\le{K}} \{\phi_1(x) + W_2(K-x)\}
$$

$W_1(K)=W^*$ - это максимальный выигрыш (доход) от всех предприятий, на этом заканчивается этап условной оптимизации.

Оптимальное управление находится на этапе основной оптимизации. То значение $x$, при котором достигается выигрыш всей задачи $W^*$, и есть оптимальное управление $x_1^*$ на первом шаге.

После вложения этих средств в предприятие $П_1$, количество средств, оставшихся перед вторым шагом, будет равно $S=K-x_1^*$. Второму предприятию $П_2$ выделяется оптимальное количество средств $x_2^*=(K-x_1^*)$ и т. д. до конца.