# Омофонический шифр замены

Система омофонов обеспечивает простейшую защиту от криптоаналитических атак, основанных на подсчёте частот появления букв в шифре текста. В омофоническом шифре каждая буква заменяется различными подставляемыми символами. В омофоническом шифре каждая буква заменяется различными подставляемыми символами. Число возможных замен берётся пропорционально вероятности появления буквы в открытом тексте.

Частота появления буквы 'A' в английских текстах составляет около 8%. Поэтому ей будет сопоставлено 8 различных символов (омофонов). Всякий раз, как в открытом тексте появится буква 'A', она будет заменена одним из восьми сопоставленных ей символов, выбираемых случайным образом. Поскольку выбор омофонов случаен, шифр в тексте каждый из них появляется равновероятно (с вероятностью около 1%). Все символы замены различны.

Омофонический шифр устойчив к частотному анализу на основе встречаемости отдельных символов, но тем не менее, подвержены анализу на основе буквенных сочетаний (диграмм, триграмм) и вероятных слов.

В отличие от рассмотренных ранее шифров однозначных замен, в которому каждому символу открытого текста ставится в соответствие один и тот же символ шифра, система омофонов является шифром многозначной замены. Криптографическое преобразование замены $F_k(X)$ может быть, вообще говоря, многозначной функцией. Выбор её значений представляет собой определённую проблему, которая делает многозначные шифры функцией $F_k(X)$ не слишком удобными для использование. Избавиться от этой проблемы позволяет использование однозначных функций, что приводит к естественному разделению всех функций замены на однозначные и многозначные замены (омофонические шифры).

Система омофонов является одноалфавитной (шифром простой замены), хотя буквы исходного сообщения имеют по несколько замен. Хотя буква открытого текста может быть представлена различными символами, каждый из этих символов всегда представляет одну и ту же букву. К тому же, после того, как шифр-алфавит был определён, он не меняется на протяжении всего процесса шифрования.

# Шифры сложной замены

Одноалфавитные (простые) и многоалфавитные (сложные) замены. В одноалфавитных соответствие между нормативным-алфавитом и шифр-алфавитом создаётся один раз до начала шифрования и не меняется на всём протяжении шифрования сообщения. В многоалфавитном шифре (шифре сложной замены) буква открытого текста может быть представлена различными символами, кроме того один и тот же символ криптограммы может обозначать разные буквы.

# Криптоанализ шифра Виженера

Пусть $М$ — длина ключевого слова. Если ключевое слово короче шифруемого текста, то ключевое слово будет последовательно повторяться, поэтому М — период ключевой последовательности.

Разобьем криптограмму на блоки, равные по длине периоду ключевой последовательности. Символы криптограммы, занимающие одинаковое положение в таких блоках, имеют одинаковое смещение относительно символов исходного текста, т.е. для их получения использован один и тог же алфавит шифрования. Этот алфавит шифрования задает шифр простой замены, а именно простейший случай замены — шифр Цезаря.

Описанное свойство дает возможность применить частотный анализ для каждой группы символов криптограммы, соответствующих определенной букве ключа. Такие группы символов называют группами периода. Первую группу периода составляют $1, М + 1,\space 2М + 1, \space \dots ,\space rM + 1$ символы, вторую группу периода - $2,\space М + 2, \space 2М + 2,\space\dots,\space гМ + 2$ символы и т.д. Число групп периода равно длине ключа $М$.

Частотный анализ символов, составляющих группу периода, позволяет криптоаналитику определить величину смещения нормативного алфавита для каждой группы, т.е. ключ шифрования. Такой метод криптоанализа может быть эффективен, если длина криптограммы п превышает $20М\space (n > 20М)$, $М$ — длина ключа.

Обычно криптоанализ шифра Виженера проводится в два этана. На первом этапе определяется число $М$, на втором этапе — само ключевое слово.

Для определения периода ключевой последовательности $М$ применяются:

- тест Казиски (1863 г.), основанный на том, что два одинаковых отрезка открытого текста, отстоящих друг от друга на расстоянии, кратном М, будут зашифрованы одинаково. В силу этого в криптограмме ищутся повторяющиеся фрагменты достаточной длины ($\ge 3$), случайное появление которых в шифротексте маловероятно, а затем определяются расстояния $d_1,\space d_2,\space \dots$ между одинаковыми фрагментами. $М$ должно оказаться среди делителей $d = НОД (d_1,\space d_2, \space \dots)$. Чем больше повторяющихся фрагментов имеется в шифротексте, тем более вероятно, что $М$ совпадет с $d$
- автокорреляционный метод. Текст криптограммы выписывается в строку, под ним выписываются строки, в которых текст сдвинут влево на одну, две, три, четыре и т.д. позиции ($t = 1,2,3,\dots$). Затем для каждой строки подсчитывается число позиций, в которых символ совпал с символом исходной строки в той же позиции ($с_i = с_{i+1}$), и вычисляются автокорреляционные коэффициенты, равные отношению числа совпадений к длине строки. Для $t$, кратных периоду ключевой последовательности, автокорреляционные коэффициенты должны быть заметно больше, чем для сдвигов, не кратных периоду;
- для проверки правильности выбора значения $М$ может быть использован метод индекса совпадения, введенный в практику в 1920 г. американским криптологом и криптоаналитиком У. Фридманом (William Frederick Friedman), впервые успешно применившим вероятностно-статистические методы в криптологии. Для каждой группы периода $X_t,t=1,\dots ,M$ вычисляется значение статистики — индекса совпадения $I_c(X_t)$:

$$
I_c(X_t) = \frac{\sum\limits_{i=0}^{N-1}f_i(f_i-1)}{m(m-1)}
$$

где $f_i, i = 0,\dots ,N - 1$ — число появлений буквы $а_i$ шифр-алфавита А мощностью N в последовательности $X_t$. Для случайной последовательности символов значение индекса соответствия будет составлять около $\frac{1}{N}$ (\~0,030 для русского языка), в то время как для осмысленных текстов его значение существенно выше (\~0,055 для русского языка). Поскольку шифр Цезаря, которым зашифрованы символы группы периода, не меняет частотных характеристик текста, заметная разница значений $I_c(X_t)$ для осмысленных текстов и случайных последовательностей позволяет в большинстве случаев установить точное значение периода ключевой последовательности $М$ в шифре Виженера.

На втором этапе требуется найти само ключевое слово, т.е. определить сдвиги $b_t,t= 1,\dots, М$ для каждой из групп периода. Это можно сделать визуально, используя гистограммы частот символов каждой из групп периода. Для решения задачи может быть использована статистика — взаимный индекс совпадения $MI_c(X_t,X_t')$:

$$
MI_c(X_t,X_t') = \frac{\sum\limits_{i=0}^{N-1}f_i \cdot f_i'}{m \cdot m'}
$$

где $f_0,f_1,\dots,f_{N-1}$ и $f_0,f_1,\dots,f_{N-1}'$ — частоты вхождений букв алфавита $А$ в группы периода $X_t$ и $X_t'$ соответственно. При нулевом сдвиге между группами периода взаимный индекс совпадения $МI_С$ близок к индексу совпадения в естественном языке, ненулевые относительные сдвиги дают более низкие значения. Используя изложенный метод, можно связать системой уравнений относительные сдвиги различных групп периода. В результате останется 33 (для русского языка) варианта для ключевого слова, из которых можно выбрать наиболее предпочтительный вариант, если ключевое слово является осмысленным. Этот метод будет эффективным для небольших значений $М$, поскольку для хороших сближений индексов совпадения требуются тексты достаточно большой длины.

В классической криптографии взлом шифров с длинными периодами представлял серьезную задачу, гораздо более трудную, чем взлом шифров с короткими периодами. Однако с использованием компьютерной техники раскрытие шифров даже с очень длинным периодом не вызывает затруднений.
