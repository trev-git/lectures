## Переходы

Команды машинной программы выполняются в том порядке, как они записаны в памяти. Но если надо, чтобы выполнялась не очередная команда, а какая-то иная, то используют команды перехода.

Переходы бывают условными (если переход делается, когда выполнено некоторое условие) и безусловными (если переход делается независимо от каких-либо условий).

Команды перехода не меняют флаги.

### Безусловный переход

```
JMP метка
(jump)
```

Пример:

```x86asm
...
JMP L
...
L: MOV AX, 0
```

### Команды условного перехода

Jxx метка

Метка указывает место той команды, на которую надо сделать переход в случае выполнения некоторого условия, а мнемокод начинается буквой J, за которой следуют буквы, описывающие условия.

Команды условного перехода можно разделить на группы
:

I. Команды, которые ставятся после команды сравнения.

CMP оп1, оп2

Команда эквивалентна команде SUB, но разность оп1-оп2 никуда не записывается, цель применения команды сравнения - установка флагов, характеризующих разность оп1-оп2 (или, что то же самое, сравниваемые величины оп1 и оп2).

Буквы мнемокода:

E - равно \
N - не, отрицание \
G - больше (для чисел \
L - меньше  со знаком) \
A - выше, больше (для чисел \
B - ниже, меньше  без знака) \

| | Условие для перехода после CMP оп1, оп2 | Состояние флагов для перехода |
| --- | --- | --- |
| для любых чисел |
| JE | оп1 == оп2 | ZF = 1 |
| JNE | оп1 != оп2 | ZF = 0 |
| для чисел со знаком |
| JL | оп1 < оп2 | SF = 1, OF = 0 или SF = 0, OF = 1 => SF != OF |
| JLE | оп1 <= оп2 | SF != OF или ZF = 1 |
| JG | оп1 > оп2 | SF = OF, ZF = 0 |
| JGE | оп1 >= оп2 | SF = 0 и OF = 0, SF = 1, OF = 1 => SF = OF |
| для беззнаковых чисел |
| JB | оп1 < оп2 | CF = 1 |
| JBE | оп1 <= оп2 | CF = 1 или ZF = 1 |
| JA | оп1 > оп2 | CF = 0 и ZF = 0 |
| JAE | оп1 >= оп2 | CF = 0 |

$$
x =
\begin{cases}
  a-b, a\ge{b} \\
  a+b, a<b
\end{cases}
$$
```x86asm
A DB ...
B DB ...
X DB ?

MOV AL, A
CMP AL, B
JGE M1
ADD AL, B
JMP M2
M1: SUB AL, B
M2: MOV X, AL
```

$$
y =
\begin{cases}
  x+1, x >= 0 \\
  x-1, x < 0
\end{cases}
$$

```x86asm
X DW ...
Y DW ?

MOV AX, X
CMP AX, 0
JGE M1
DEC AX
JMP M2
M1: INC AX
M2: MOV Y, AX
```

```
Если x >= 10, то x := 10
```

```x86asm
X DW ...
MOV AX, X
CMP AX, 10
JGE M1
JMP M2
M1: MOV AX, 10
M2: MOV X, AX
```

```
b = |a|
```

```
A DB ...
B DB ?

MOV AL, A ; AL = A
CMP AL, 0 
JL M1 ; AL < 0
JMP M2 ; AL >= 0
M1: NEG AL ; AL < 0
M2: MOV B, AL
```

```
max = max(a, b)
```

```x86asm
A DW ...
B DW ...
MAX DW ?

MOV AX, A
CMP AX, B
JAE M1
MOV AX, B
M1: MOV, MAX, AX
```

```
y = min(x1, x2, x3, x4)
```

```x86asm
X1 DW ...
X2 DW ...
X3 DW ...
X4 DW ...
Y DW ?

MOV AX, X1
CMP AX, X2
JBE M1
MOV AX, X2
M1: MOV AX, X1
CMP AX, X3
JBE M2
MOV AX, X3
```