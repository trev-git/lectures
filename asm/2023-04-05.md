### Константные выражения

Простейшие константные выражения:

- число
- символ
- строка из двух символов
- имя константы

Константные операторы, т.е. операторы с константным значением:

- арифметические операторы
  - одноместные плюс и минус: +k, -k;
  - операторы сложения и вычитания: k1+k2, k1-k2
  - операторы умножения и деления: k1\*k2, k1/k2, k1 MOD k2 (* - умножение, / - деление нацело, MOD - взятие остатка от деления)
- оператор типа: TYPE имя, его значение - размер (в байтах) ячейки выделенной под переменную с указанным именем.

Операндами арифметических операторов должны быть константные выражения, кроме того разрешается вычитание одного адреса из другого.

Вычитание адресов используется для определения расстояния (числа байтов) между этими адресами.

X DW 1,2,3,4,5
Y DB ?
SIZE_X EQU Y - x ; SIZE_X = 10

X DB ? ; TYPE X = 1

Есть стандартная константа BYTE = 1, => TYPE X = BYTE

Q DB '*'
V DB TYPE Q ; V DB 1

M DB 2, -2, ?, '*' ; TYPE M = 1

S DB 'abc' ; TYPE S = 1

A DW ? ; TYPE A = 2

WORD = 2 DWORD = 4 => TYPE A = WORD

### Адресные выражения

Простейшие адресные выражения:

- метка, имя переменной;
- счётчик размещения $ - адрес того предложения, в котором он встретился.

A DW $ ; A DW 100h
B DW $ ; B DW 102h

Счётчик размещения используется для вычисления размера памяти, занимаемой каким-то массивом.

X DW 40 DUP(?)
SIZE_X EQU $-X ; SIZE_X = 80

Операторы, значением которых являются адреса:

- сложение адреса с числом: a+k или k+a (значение - адрес, полученный прибавлением к адресу a числа k).
- вычитание константы из адреса: a-k (значение - адрес a, уменьшенный на величину k).

Адресные выражения $a \pm k$ используются для ссылок на безымянные ячейки памяти.

A DB 0, 1, 2, 3 \
B DB 4

A+3

## Команды пересылки

MOV оп1, оп2 ; оп1 := оп2

Флаги команда не меняет.

Операнды должны быть одинакового типа.

Допустимые операнды:

| оп1 | оп2 |
| --- | --- |
| регистр общего назначения | константное выражение, регистр общего назначения, адресные выражения или сегментные регистры |
| адресное выражение | константное выражение, регистр общего назначения, сегментный регистр |
| сегментный регистр (кроме CS) | регистр общего назначения, адресное выражение |

Запрещены пересылки:

- из одной ячейки памяти в другую
- из одного сегментного регистра в другой
- запись непосредственного операнда в сегментный регистр.

Если нужно выполнить такое действие, оно реализуется в 2 команды пересылкой через какой-нибудь несегментный регистр

DS <- 100

MOV AX, 100 ; AX := 100
MOV DS, AX  ; DS := AX := 100
